enum user_role {
  administrator
  member
}

enum video_type {
  upload
  youtube
}

table accounts {
  userId text [not null]
  type text [not null]
  provider text [not null]
  providerAccountId text [not null]
  refresh_token text
  access_token text
  expires_at integer
  token_type text
  scope text
  id_token text
  session_state text

  indexes {
    (provider, providerAccountId) [pk]
  }
}

table authenticators {
  credentialID text [not null, unique]
  userId text [not null]
  providerAccountId text [not null]
  credentialPublicKey text [not null]
  counter integer [not null]
  credentialDeviceType text [not null]
  credentialBackedUp boolean [not null]
  transports text

  indexes {
    (userId, credentialID) [pk]
  }
}

table events {
  id serial [pk, not null, increment]
  name text [not null]
  image_url text
  registration_url text
  scheduled_start timestamp [not null]
  scheduled_end timestamp [not null]
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  registration_fee integer
  description text
}

table events_speakers {
  event_id integer [not null]
  user_id text [not null]

  indexes {
    (event_id, user_id) [pk]
  }
}

table events_videos {
  event_id integer [not null]
  video_id integer [not null]

  indexes {
    (event_id, video_id) [pk]
  }
}

table sessions {
  sessionToken text [pk, not null]
  userId text [not null]
  expires timestamp [not null]
}

table users {
  id text [pk, not null]
  name text
  email text [not null]
  emailVerified timestamp
  image text
  user_role user_role [not null, default: 'member']
  username text [not null, unique]
}

table verificationTokens {
  identifier text [not null]
  token text [not null]
  expires timestamp [not null]

  indexes {
    (identifier, token) [pk]
  }
}

table videos {
  id serial [pk, not null, increment]
  title text [not null]
  description text
  video_url text [unique]
  thumbnails json
  video_type video_type [not null, default: 'upload']
  published_at timestamp [not null, default: `now()`]
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
}

table videos_speakers {
  video_id integer [not null]
  user_id text [not null]

  indexes {
    (video_id, user_id) [pk]
  }
}

ref: events_speakers.event_id > events.id

ref: events_speakers.user_id > users.id

ref: events_videos.event_id > events.id

ref: events_videos.video_id > videos.id

ref: videos_speakers.video_id > videos.id

ref: videos_speakers.user_id - users.id